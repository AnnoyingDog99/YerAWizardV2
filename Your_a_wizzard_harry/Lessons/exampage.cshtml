@{
    string connectionString = @"Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\Harry_Potter.mdf;Integrated Security=True";

    string provider = "System.Data.SqlClient";
    Database db = Database.OpenConnectionString(connectionString, provider);

    string mail = "";
    string GetquestionId;
    string Getquestion;
    string Getexamid;
    string question;
    int amountofquestion ;
    int totalpoints = 0;
    int questionId;
    int Exam_Id;
    int counter = Request.QueryString["counter"].AsInt();
    int lesson_Id = Request.QueryString["lesson_id"].AsInt();



    Getexamid = "SELECT exam_Id from exam where Lesson_Id = @0";
    Exam_Id = db.QueryValue(Getexamid, lesson_Id);
    string getamountofquestions = "SELECT COUNT(question) FROM Questions WHERE exam_Id = @0";
    amountofquestion = db.QueryValue(getamountofquestions, Exam_Id);

    if (Session["totalpoints"] != null)
    {
        totalpoints = Convert.ToInt32(Session["totalpoints"]);
    }
    if(Session["mail"] !=null)
    {
        mail = Convert.ToString(Session["mail"]);
    }
    string getusername = "SELECT Username FROM Profiel WHERE Email = @0";
    string username = db.QueryValue(getusername, mail);
    string checkifisfraud = "SELECT Marked_Lesson From Profiel_Has_Lesson WHERE Profiel_Username = @0 AND Lesson_Id = @1";
    var marked_lesson = db.QueryValue(checkifisfraud, username, lesson_Id);
    if (marked_lesson == true)
    {
        Response.Redirect("~/Lessons/Lessons");
    }
    if (IsPost)
    {


        int answer_Id = Request.Form["Q1"].AsInt();
        string checkifcorrect = "SELECT corret From answer where answer_Id = @0";
        var iscorrect = db.QueryValue(checkifcorrect, answer_Id);

        if (iscorrect == true)
        {

            GetquestionId = "SELECT Question_Id from Questions where exam_Id = @0 AND Order_Prio = @1";
            questionId = db.QueryValue(GetquestionId, Exam_Id, counter);
            string getpoints = "SELECT points FROM Questions where Question_Id = @0";
            int pointforquestion = db.QueryValue(getpoints, questionId);
            totalpoints = totalpoints+pointforquestion;
        }
        if ( counter == amountofquestion && counter != 0)
        {
            string pushpointsforusers = "SELECT User_Points FROM Profiel WHERE Email = @0";
            var userpoints = db.QueryValue(pushpointsforusers, mail);


            string gethouseId = "SELECT House_House_Id FROM Profiel WHERE email = @0";
            int houseId = db.QueryValue(gethouseId, mail);
            string gethousepoints = "SELECT Points FROM house WHERE House_Id = @0";
            int housepoints = db.QueryValue(gethousepoints, houseId);
            int newhousepoints = housepoints + totalpoints;
            int newuserpoints = userpoints + totalpoints;
            string pushhousepoints = "UPDATE House SET Points = @0";
            var push = db.Execute(pushhousepoints, newhousepoints);
            string pushUserpoints = "UPDATE Profiel SET User_Points = @0";
            push = db.Execute(pushUserpoints, newuserpoints);
            string insertuserandteacher = "Insert Into Profiel_has_Lesson (Lesson_Id,Profiel_Username,Marked_Lesson) VALUES (@0,@1,@2)";
            push = db.Execute(insertuserandteacher, lesson_Id,username,1);
            Response.Redirect("~/Lessons/Lessons");


        }
        counter++;

    }

    string selectexam = "SELECT exam_name From Exam WHERE Lesson_Id = @0";
    var GetExam = db.QueryValue(selectexam, lesson_Id);

    Getexamid = "SELECT exam_Id from exam where Lesson_Id = @0";
    Exam_Id = db.QueryValue(Getexamid, lesson_Id);
    Getquestion = "SELECT Question from Questions where exam_Id = @0 AND Order_Prio = @1";
    GetquestionId = "SELECT Question_Id from Questions where exam_Id = @0 AND Order_Prio = @1";
    question = db.QueryValue(Getquestion, Exam_Id, counter);
    questionId = db.QueryValue(GetquestionId, Exam_Id, counter);


    string getanotherawnser = "SELECT answer , answer_Id FROM answer WHERE  Question_Id = @0";
    var answers = db.Query(getanotherawnser, questionId);



    Session["totalpoints"] = totalpoints;
    Session["mail"] = mail;
}

<h1>@question</h1>
<form method="post" action="~/Lessons/exampage.cshtml?lesson_Id=@lesson_Id&counter=@counter">
    @foreach (var answer in answers)
    {

        <input type="radio" name="Q1" value="@answer.answer_Id" />@answer.answer<br />
        <br />
        @totalpoints;
    }
    <input type="submit" value="Question 2" />
</form>
