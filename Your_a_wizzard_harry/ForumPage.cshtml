@{
    Layout = "~/_SiteLayout.cshtml";
    Page.Title = "Forums";
    PageData["current"] = "Forums";

    string Rank = "";

    string connectionString = @"Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\Harry_Potter.mdf;Integrated Security=True";
    string provider = "System.Data.SqlClient";
    Database db = Database.OpenConnectionString(connectionString, provider);

    if (Session["mail"] != null)
    {
        Rank = db.QuerySingle("SELECT Rank FROM Profiel WHERE Email = @0", Session["mail"]).Rank;
    }
    else
    {
        Response.Redirect("login.cshtml");
    }
    var UserData = db.QuerySingle("SELECT * FROM Profiel WHERE Email = @0", Session["mail"]);
    if (UserData != null)
    {
        Rank = UserData.Rank;
    }
    var General = db.Query("SELECT * FROM Forum WHERE Category = 'General'");
    var Community = db.Query("SELECT * FROM Forum WHERE Category = 'Community'");

}
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link href="~/Stylesheets/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="~/Stylesheets/Layout.css" rel="stylesheet" type="text/css" />
    <link href="~/Stylesheets/ForumSelect.css" rel="stylesheet" type="text/css" />
</head>
<body style="background-color: #202225;">
    <div style="padding-top: 30px;"></div>
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="wrapper wrapper-content animated fadeInRight">
                    <div class="ibox-content m-b-sm border-bottom" style="background-color: #343a40">
                        <div class="p-xs">
                            <div class="pull-left m-r-md">
                                <!-- Logo -->

                            </div>
                            <h2 style="color: white;">Welcome to our forum</h2>
                            <span style="color: white;">Feel free to choose topic you're interested in.</span>
                        </div>
                    </div>

                    <div class="ibox-content forum-container" style="background-color: #343a40">
                        <div class="forum-title">
                            <h3 style="color: white;">General</h3>
                        </div>

                        @foreach (var forum in General)
                        {
                            var AmmountOfPosts = db.QuerySingle("SELECT COUNT(Post_Id) AS Amount FROM Post WHERE Forum_Forum_Id = @0", forum.Forum_Id);
                            <div class="forum-item active">
                                <div class="row">
                                    <div class="col-md-11">
                                        <div class="forum-icon">
                                            <i class="fa fa-@forum.Icon"></i>
                                        </div>
                                        @if (forum.IsPrivate != "Y" || Rank == "Owner" || Rank == "Teacher")
                                        {
                                            <div>
                                                @if (forum.IsPrivate == "Y" && Rank == "Owner" || forum.IsPrivate == "Y" && Rank == "Teacher")
                                                {<a href="PostPage.cshtml?ForumId=@forum.Forum_Id" class="forum-item-title"><i style="color: #acacac" class="fa fa-lock"></i>&nbsp;@forum.Forum_name</a> }
                                            else
                                            { <a href="PostPage.cshtml?ForumId=@forum.Forum_Id" class="forum-item-title">@forum.Forum_name</a>}
                                            </div>
                                        }
                                        else
                                        {
                                            <i style="color: #808080" class="fa fa-lock"></i>
                                            <label class="link-replace" href="PostPage.cshtml?ForumId=@forum.Forum_Id">@forum.Forum_name</label>
                                        }
                                        <div class="forum-sub-title">@forum.Description</div>
                                    </div>

                                    <div class="col-md-1 forum-info">
                                        <span class="views-number" style="color: white;">
                                            @AmmountOfPosts.Amount
                                        </span>
                                        <div>
                                            @if (AmmountOfPosts.Amount == 1)
                                            {
                                                <small>Post</small>
                                            }
                                            else
                                            { <small>Posts</small>}
                                        </div>
                                    </div>
                                    @if (Rank == "Owner" || Rank == "Teacher")
                                    {
                                        <div id="EdDel">
                                            <a href="~/ForumManage.cshtml?ForumId=@forum.Forum_Id">Edit</a>
                                            &nbsp;
                                            <a style="color: #a00000" href="~/ForumDelete.cshtml?ForumId=@forum.Forum_Id">Delete</a>
                                        </div>
                                    }
                                </div>
                            </div>
                        }

                        <div style="padding-bottom: 20px;"></div>
                        <div class="forum-title">
                            <h3 style="color: white;">Community</h3>
                        </div>
                        @foreach (var forum in Community)
                        {
                            var AmmountOfPosts = db.QuerySingle("SELECT COUNT(Post_Id) AS Amount FROM Post WHERE Forum_Forum_Id = @0", forum.Forum_Id);
                            <div class="forum-item">
                                <div class="row">
                                    <div class="col-md-11">
                                        <div class="forum-icon">
                                            <i class="fa fa-@forum.Icon"></i>
                                        </div>
                                        @if (forum.IsPrivate != "Y" || Rank == "Owner" || Rank == "Teacher")
                                        {
                                            <div>
                                                @if (forum.IsPrivate == "Y" && Rank == "Owner" || forum.IsPrivate == "Y" && Rank == "Teacher")
                                                {<a style="color: white;" href="PostPage.cshtml?ForumId=@forum.Forum_Id" class="forum-item-title"><i style="color: #acacac" class="fa fa-lock"></i>&nbsp;@forum.Forum_name</a> }
                                            else
                                            { <a style="color: white;" href="PostPage.cshtml?ForumId=@forum.Forum_Id" class="forum-item-title">@forum.Forum_name</a>}
                                            </div>
                                        }
                                        else
                                        {
                                            <i style="color: #808080" class="fa fa-lock"></i>
                                            <label class="link-replace-white" href="PostPage.cshtml?ForumId=@forum.Forum_Id">@forum.Forum_name</label>
                                        }
                                        <div class="forum-sub-title">@forum.Description</div>
                                    </div>

                                    <div class="col-md-1 forum-info">
                                        <span class="views-number" style="color: white;">
                                            @AmmountOfPosts.Amount
                                        </span>
                                        <div>
                                            @if (AmmountOfPosts.Amount == 1)
                                            {
                                                <small>Post</small>
                                            }
                                            else
                                            { <small>Posts</small>}
                                        </div>
                                    </div>
                                    @if (Rank == "Owner" || Rank == "Teacher")
                                    {
                                        <div id="EdDel">
                                            <a href="~/ForumManage.cshtml?ForumId=@forum.Forum_Id">Edit</a>
                                            &nbsp;
                                            <a style="color: #a00000" href="~/ForumDelete.cshtml?ForumId=@forum.Forum_Id">Delete</a>
                                        </div>
                                    }
                                </div>
                            </div>
                        }
                        @if (Rank == "Owner" || Rank == "Teacher")
                        {
                            <div class="container">
                                <div class="float-right">
                                    <a class="add-btn" href="~/ForumManage.cshtml"><i class="fas fa-plus"></i>&nbsp; <span>Add Forum</span></a>
                                </div>
                            </div>
                        }
                        <div style="padding-bottom: 30px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div style="padding-bottom: 50px;"></div>
</body>
</html>